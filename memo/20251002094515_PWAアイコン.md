# PWAアイコン


* ファイル形式は何にすべきか
* 縦横サイズはいくつにすべきか
* 使用する色は何にすべきか

<!-- more -->

# AIに質問

> PWA アイコン サイズ いくつにすべきか

# AIの解答

PWAのアイコンサイズは、一般的に512x512pxと192x192pxを用意し、Web App Manifestファイルに記載します。特にAndroidのアダプティブアイコンに対応するには、「maskable」用のアイコンを用意すると、さまざまな形状のアイコン表示に対応でき、見た目が良くなります。﻿

## PWAアイコンに必要なサイズ

### 512x512pxと192x192px:

　これらのサイズは Chromium系ブラウザで最低限必要であり、ユーザーがホーム画面に追加する際に表示されます。﻿

### maskableアイコン:

　Android端末で円形など、様々な形にアイコンが切り抜かれる（マスクされる）場合に、その形状にきれいに収まるように作成します。﻿

## アイコン作成のポイント﻿

### セーフエリア（安全領域）:

　Maskableアイコンでは、アイコンの中心から短辺の80%の直径の円形内（安全領域）にロゴやシンボルを収めるように作成します。この領域外はOSによって切り抜かれる可能性があるためです。

### アイコンの種類:

種類|概要
----|----
`any`|最も汎用的なアイコンで、マスクされず表示されます。
`maskable`|マスクされても表示が崩れないようにデザインされたアイコンです。
`monochrome`|色情報が破棄され、透明度のみが利用され、塗りつぶしのマスク用途に使用されます。

* https://www.gaji.jp/blog/2023/06/20/16156/
* https://w3c.github.io/manifest/#purpose-member

## 実装方法

### アイコン画像を用意する:

　512x512px, 192x192pxのアイコンと、必要に応じてmaskableアイコンを作成します。﻿

### Web App Manifestに設定する:

　manifest.json ファイルの icons プロパティに、各アイコンのsrc（ファイルパス）とsizes、type、purposeを記述します。﻿

### ブラウザで確認する:

　https://maskable.app/などのツールで、作成したmaskableアイコンがどのように表示されるかを確認できます。﻿

# 実際に作る

　Javel用のアイコンを作る。

* 512めいっぱい使用する
* 80%サイズに縮める（512*0.8=409.6）

　実際には整数ピクセルしかないpng形式に落とし込むなら、最初から`409`、偶数にして`408`にしたほうが良いはず。

　ただ、SVGなら少数点数も可能なので512で実装し、それを縮小した画像を用いても良さそう。最悪、僅かに隅が削れても良いなら問題ないはず。

## Javelアイコン

　日本の`日`を横に倒して本のように見せる図形にする。その中は白で、中央は赤い丸。日本の国旗を示す。

　縦横比は本のそれと同じにする。つまり白銀比である`1:√2`。`1:1.414`。長辺である横√2が512pxの場合、短辺である縦1は約362pxになる。

```
1:√2=x:512
√2x=512
   512
x=-----=362.09
   √2
```

## 日本の国旗における日の丸のサイズ比

　「日本国旗 円 比率」で検索したらAIによる以下の解答を得られた。

日本の国旗「日の丸」は、国旗国歌法により、縦横の比率が2対3と定められています。そして、赤い「日の丸」の直径は旗の縦の長さの5分の3と決められており、円は旗の正確な中心に位置します。﻿
詳細な比率﻿

    全体の縦横比:2:3
    日の丸の直径:縦の長さの5分の3
    日の丸の位置:旗の中心

以前の規定との違い
1999年に国旗国歌法が制定される以前は、法律による正式な規定がありませんでした。そのため、過去には旗の比率や日の丸の大きさ・位置が異なっており、例えば1998年の長野冬季オリンピックでは、雪の中でより目立つように縦の長さの3分の2の直径の日の丸が使用されました。﻿

　以上。

　つまり、横2縦3の白矩形で、その中央に赤い円が3/5。

## 国旗と本の縦横比

対象|横|縦
----|--|--
国旗|3|2
本|√2|1

対象|横|縦
----|--|--
国旗|1.5|1
本|√2|1

対象|横|縦
----|--|--
国旗|1.5|1
本|1.414|1

　大凡同じである。


## 国旗と本の日の丸サイズ比

　国旗の日の丸の直径は縦の長さの3/5である。

対象|横|縦|丸
----|--|--|--
国旗|1.5|1|3/5
本|1.414|1|?

対象|横|縦|丸
----|--|--|--
国旗|1.5|1|0.6
本|1.414|1|?

　Javelアイコンのサイズを`象`とすると次のようになる。

対象|横|縦|丸
----|--|--|--
国旗|1.5|1|0.6
本|1.414|1|?
象|512px|362px|217px

　Javelアイコンにおける日の丸のサイズは217pxである。

```
362px * 0.6 = 217px
```

　だが、これだと太陽の日の丸が主役になってしまう。
　Javelにおいて主役は本である。つまり日の丸を含めた外側であり、日の丸を二つに分割する中心線である`日`を横に倒した枠こそが主役だ。よって日の丸は小さくして自己主張させぬようにしたい。

　160px。512px全体においては`0.3125`。つまり全体の31.25%。1/3未満。無視できる大きさではないが、主役と呼ぶには小さい。ただ、中央にあることと、縦362pxからみれば`0.441988950276`つまり縦の`44.19`%である。1/2未満ではあるが、中央にあることから十分に主役と呼べる。

対象|横|縦|丸
----|--|--|--
国旗|1.5|1|0.6
本|1.414|1|?
象|512px|362px|160px(全0.3125/縦0.4419)

　`日`を表す枠の太さ（ストローク）は何pxにすべきか？

　とりあえず適当に`32px`にしたが、やや細い気がする。

　32/512=0.0625。約`6.25`%。上下や左右を合わせても12%, 25%。日の丸は30%を超えてると考えると負けている。

　そこで適当に`48px`にしてみる。`48/512=0.09375`、`9.375`%。上下左右合わせて`0.375`。最低でもこのくらいは欲しい。
　但し外枠は`48px`、内の縦棒は`32px`にする。内線まで太くすると日の丸が潰れてしまうため。また、`日`を本に見立てるなら内線は本の中央であり、窪みであるため、細くしたほうがそれっぽい。さりとて`日`の字として違和感のないようにしたい。よって、各部位をこのサイズとした。

　`日`でありながら`本`を意識させたい。そこで中央が窪みであることを意識させるため一部削りたい。中央上部を`▼`、中央下部を`▲`で削り透明にする。このとき三角形の底辺を`48px`とする。三角形の高さは`日`の横棒の幅の半分までしか削れないものとする。それ以上削ったら主役である本を表す枠の存在感が薄れてしまうから。つまり底辺長さ`48px`、高さ`24px`の三角形を作りたい。

## ダークモード

　SVG内でCSSの`@media`を使用するとダークモードを実装可。

```svg
<style>
.paper {fill: #fff;}
@media (prefers-color-scheme: dark) {
  .paper {fill: #000;}
}
</style>
<path g="..." class="paper" style="fillプロパティはここに書かないこと。書くとその値で固定されてしまうため。">
```

　または`color:currentColor;`のようにしてもいい。

## maskable化

　アイコンはしばしば円形でくり抜かれて端が削られてしまい全体の中央部分しか見えない状態になることがある。それでも全体やアイコンの主要部分が視認可能なアイコンを「maskableアイコン」と呼ぶ。このmaskableアイコンを使って円形や角丸などの形でくり抜いたものを「アダプティブ アイコン」と呼ぶ。

　特にAndroidはPWAアプリをインストールするとアダプティブアイコンになる。よってmaskableアイコンを作成するほうが良い。全体を俯瞰するなら以下URL参照。

* https://developer.mozilla.org/ja/docs/Web/Progressive_web_apps/How_to/Define_app_icons#%E3%83%9E%E3%82%B9%E3%82%AF%E3%81%AE%E5%AF%BE%E5%BF%9C

　総合的に考えると5つの画像があれば全環境に対応可能。すなわち共用1個、ブラウザ用2個、PWA用2個。

* https://techracho.bpsinc.jp/hachi8833/2025_02_17/149053

```html
<link rel="icon" href="/favicon.ico" sizes="32x32">
<link rel="icon" href="/icon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png"><!-- 180×180 -->
```
```html
<link rel="manifest" href="/manifest.webmanifest">
```
```json
{
  "icons": [
    { "src": "/icon-192.png", "type": "image/png", "sizes": "192x192" },
    { "src": "/icon-mask.png", "type": "image/png", "sizes": "512x512", "purpose": "maskable" },
    { "src": "/icon-512.png", "type": "image/png", "sizes": "512x512" }
  ]
}
```

形式|サイズ|maskable|用途
----|-------|--------|----
PNG|32x32|×
PNG|180x180|×
PNG|192x192|×
SVG|512x512|×
SVG|512x512|○

　maskableの視認性確認に関しては以下エディタを使う。

* https://maskable.app/editor

　画像をInkscapeなどで作成するときは、全矩形サイズ512pxとすると、512*0.4=204.8pxの半径の円つまり`409.6px`の直径の円に収まればmaskableと言える。

　ダークモードの表示確認は以下エディタを使う。

* https://nanase.cc/tools/svg/theme-checker
* https://zenn.dev/nanase_t/articles/7c14092b24424c

　コード圧縮には以下を使う。但しテキスト入力したダークモード部分のコードが破壊されてしまうため、最終的には人力でコード入力と表示確認をした。

* https://jakearchibald.github.io/svgomg/

