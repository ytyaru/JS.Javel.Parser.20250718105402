# PWAで別スレッド化する意義がない

　このツールにおいて問題なのはページ分割する時の座標計算に時間がかかることだ。これを解決するためPWAによる別スレッドでページ分割計算すれば良いと思ったのだが、それは不可能だと判明した。

## js workerでDOM描画の座標を計算する方法

　見出しでググったら以下AI解答を得た。

> Web WorkerではDOMに直接アクセスできないため、DOM要素の座標を計算することはできません。DOMの座標を取得するには、メインスレッドで`Element.getBoundingClientRect()`メソッドを使用し、その結果をポストメッセージでWeb Workerに渡す必要があります。

　座標計算で時間がかかるのは、一文字ずつTextNodeを追加する度に`Element.getBoundingClientRect()`するせいである。しかしその最も重い処理はUIメインスレッドでしか実行できないため、結局フリーズを解消できない。よってPWAで別スレッド化する意義は薄いと判断した。

## インストール

　但しPWAにするとブラウザからURLアクセスでき、しかもインストールでき、オフライン動作できる。この点においてPWA化する意義があると考える。

