# Javel機能

　Javel形式テキストからHTMLを表示・ファイル出力する。

<!-- more -->

# 機能

機能名|役割
------|----
Parser|Javel形式のテキストをHTML形式に変換する（Element型に変換しDocumentに直接入力して表示も可）
Splitter|HTMLをページ分割する（紙面／画面においてキリのいい単位で分割するHTMLを生成する`<div class="page">`）

PageStyler|
PageMaker|
PageSplitter|
PageViewer|

分割型|和訳|意味
------|----|----
`scroll`|巻物|block方向へスクロールする（分割しない）
`slide`|スライド|見出し単位でページ分割する
`newspaper`|新聞|画面単位でページ分割する（所定の画面内に複数の矩形領域をなるだけ余白を少なくして敷き詰める）
`book`|本|画面単位でページ分割する（所定の画面内に所定のテキストや画像をなるだけ余白を少なくして敷き詰める）
`novel`|小説|画面単位でページ分割する（所定の画面内に所定のテキストや画像をなるだけ余白を少なくして敷き詰める）

## HTML/CSS

```css
:root {
  --split-type: scroll/slide/newspaper/book/novel
  --page-inline-size: 640px;
  --page-block-size: 480px;
  --column-width: 1;
  --column-count: auto;
  --column-gap: 2em;
  --writing-mode: horizontal-tb;
  --text-orientation: mixed;
  --font-size: 16px;
  --line-height: 1.7em;
  --letter-spacing: 0.05em;
}
.page {
  inline-size: var(--page-inline-size);
  block-size: var(--page-block-size);
  display: none/block/flex/grid;
  column-width: var(--column-width);
  column-count: var(--column-count);
  column-gap: var(--column-gap);
  writing-mode: var(--writing-mode);
  text-orientation: var(--text-orientation);
  font-size: var(--font-size);
  line-height: var(--line-height);
  letter-spacing: var(--letter-spacing);
}
.page.dummy {display: block;}
.page.show {display: block;}
```
```html
<div class="book" data-split-type="novel">
  <div class="page cover" data-page="1">
  </div>
  <div class="page show" data-page="2">
    <h1>見出し</h1>
    <p>本文。</p>
  </div>
  <div class="page show" data-page="3">
  </div>
  <div class="page back-cover" data-page="4">
  </div>
</div>
```

## 作品一覧

```
キャッチコピー(35字)
タイトル(100字)(表示は40字迄。超過字末尾…固定)　著者(20字)　
ジャンル(12字)　字数(999,999字)　完結(未完 yyyy-mm-dd)
あらすじ(800字)(表示は80字迄。超過字末尾…固定)
```


## CLI

```sh
javel2html some.javel some.html
```

* 動的サイズでページ分割（原稿をHTML内部に入れて表示するたび動的ページ分割処理実行）
* 固定サイズにページ分割
    * CSS固定
    * HTML固定

```

```

## page

### 小説

　ページ内に含むブロック要素は見出し`<h1>`と段落`<p>`のみ。他`<hr>`,`<br>`がある。

```html
<div class="page" data-page="1">
  <h1>見出し</h1>
  <p>本文。</p>
  <hr>
  <br>  
</div>
```

　インライン要素はプレーンテキスト、`<br>`、`<ruby>`, `<em>`, `<mark>`のみ。

```html
<h1>平文。<ruby>漢字<rp>（</rp><rt>かんじ</rt>rp>）</rp></ruby><em>強調</em><mark>検索ヒット</mark></h1>
<p>平文。<ruby>漢字<rp>（</rp><rt>かんじ</rt>rp>）</rp></ruby><em>強調</em><mark>検索ヒット</mark</p>
```

　場合によっては縦中横や注釈の`<span>`,`<div>`を追加する可能性がある。

　また、挿絵として`<img>`,`<picture>`を追加する可能性がある。

```html
<img src="">
<picture>...</picture>
```

## ページ分割

1. 画面表示
2. 紙面印刷

### 1. 画面表示

　PCやスマホなど異なる画面サイズにおいて本のように最適な表示をしたい。既存のスクロールだと次のような問題がある。

* 文字が見切れる
* 開始行がどの位置かわからない（微妙にズレたりする）

　快適な読書体験のため、上記問題を解決すべく本のようにページ分割したい。

### 2. 紙面印刷

　A4やB5など固定された紙面サイズに見切れることなく全文を印字したい。

# 画面構成

```
# Javel

[閲覧する]　☑DnD時閲覧
[ダウンロードする]

## 原稿

[URL]
[ファイル選択]
---
Javel原稿テキストエリア
---

## ページ設定

☑現在のウインドウサイズに合わせる
[1980]x[1080] [全画面化]
[小説▼][縦書き▼]

### フォント

ファミリ
　見出：[]
　本文：[]
サイズ
　[40]字／行
　[0.05]em 字間
　[1.70]em 行間

### 段組

　[2]段[2]em間隔

```



