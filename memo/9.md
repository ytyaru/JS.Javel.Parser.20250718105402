# アプリ実行形式のパターン網羅

　ブラウザアプリをどのような実行形式で提供すべきか。

　ブラウザアプリはHTML,CSS,JSの3言語で実装するが、それらはインタプリタ言語であり毎回コードを読んで実行する。C言語のようにコンパイルしてオブジェクトファイル化しないため、実行に最適化された実行ファイルは存在しない。よってインタプリタ言語であるJavaScriptのコードを実行に最適化するためには、ファイルを一つにまとめたり、コードを短縮する必要がある。しかしそれらを行えばコードの保守性・再利用性・可読性が犠牲になる。つまりインタプリタ言語は実行パフォーマンスとコード保守性がトレードオフの関係にある。

　言うまでもなく、両方共欲しい。よってパフォーマンスに最適化されたコードと、コードの保守性・再利用性・可読性に最適化されたコードの少なくとも二種類のコードを用意したい。

　Node.jsのTypeScriptでトランスパイルしてJavaScriptのコードを生成するのが現代のやり方だ。しかしNode.jsに依存せずブラウザだけで実現したい。

　まずはどのような観点があるか網羅する。

## コード形態パターン

観点|値|概要
----|--|----
protocol|`file`, `https`(`HTML`/`SPA`), `PWA`|`file`はオフラインで完全動作するが使用可能APIが少ない。`https`は逆。`PWA`は中間。
ES|5, 2015+|低いほど古い環境でも動作するがコード量が増えパフォーマンス低下する
bundle|YES/NO|コードを一つにまとめるか否か。パフォーマンス／コード可読性・再利用性のトレードオフ。
minify|YES/NO|コードを短縮するか否か。パフォーマンス／コード可読性・再利用性のトレードオフ。
module|YES/NO|JavaScriptのスコープをファイル単位で扱うか否か。コード保守性／パフォーマンスのトレードオフ。
compress|YES/NO|DL時ファイルをGZip圧縮するか。

重視|protocol|ES|bundle|minify|module|compress
----|--------|--|------|------|------|--------
パフォーマンス|`PWA`|2015+|○|○|×|-
コード保守・再利用・可読|`file`|2015+|×|×|×|-
コード保守・再利用・可読(Module版)|`file`|2015+|×|×|○|-

* デバイス
    * PC
    * スマホ
* CPU
    * CISC
        * `x86`(32bit), `x64`(64bit), `x86_64`(32bitCPUで64bitとする)
        * IA-32, IA-64
    * RISC
        * `amd64`
        * `arm`(`ARMv7`)
        * `arm64`(`ARMv8`(`AArch32`/`AArch64`))
* GPU
    * CPU（GPU使用不能）
    * WebGL（GPU使用可能だが専用言語GLSLが必要。OpenGL ESからの派生）
    * WebGPU（GPGPUが使用可能）
* OS
    * PC
        * Linux
        * Windows
        * Mac
    * スマホ
        * Android
        * iOS
* ブラウザ
    * Chrome(Blink(Webkit派生))
    * Firefox(Gecho)
    * Opera(Blink(Webkit派生))
    * Edge(Blink(Webkit派生)Windows for Microsoft)
    * Safari(Webkit。Mac/iOS for Apple)

### コード短縮・ファイル圧縮ツール

* コード短縮／コード整形（HTML/CSS/JS/WASM）
* ファイル圧縮／ファイル展開（GZIP）
* Javel/HTML相互パース
* ページ分割計算（ブラウザではdocument必須のため独立ライブラリ化不能）

## ユーザ視点からの優先度

1. ライトユーザが簡単に使えること
2. ミドルユーザが簡単に学べること
3. ヘビーユーザが簡単に改変できること

# 

````
Javel 本のように読める小説アプリ▼ 🐙

* 画面サイズに応じてページ分割される
* Markdownや青空文庫のような簡易記法で執筆できる
* 永久無料・登録不要・改変自由・営利排除・創作目的▼
    * 永久無料：将来に渡りユーザに金銭支払いなど一切何も強要しません
    * 登録不要：メアド、電話番号、生体情報、IP、その他一切の個人情報提示を強要しません
    * 改変自由：オープンソースであり自由にカスタマイズすることを許可します
    * 営利排除：ユーザ損失であるメタクソ化の原因すなわち営利目的・利益追求を徹底排除します▼
        * 販売
            * 金銭を支払わねば利用権がない
        * 広告
            * 広告表示によるアプリ品質・ユーザ体験の低下・破壊活動への加担
                * 社会損害（情報漏洩、消費電力増大、環境破壊）
                * 個人損害（経済・時間・労力損失：不快不要表示、パケット通信量/費増大）
        * アプリストア
            * 囲い込み戦略による特定企業・サイトによる監視・制約を徹底排除し自由なインストールと利用を保証します
        * 法律
            * 営利目的を実現するために強要される規約の遵守や変更の確認などユーザにとって無用な負担を徹底排除します
        * 権威
            * 権威により利益追求する全ての行為・姿勢・思想・社会体制などを徹底排除します
    * 創作目的：ユーザが小説の読み書きを楽しめることを最優先します▼
        * 創作活動それ自体を楽しむことを妨げることになるため営利目的・利益追求は徹底排除します
        * 主役はユーザ自身であり他者に支配・操作されるべきではありません
        * ユーザが社会、組織、権威者、開発者、他ユーザなど何者にも支配されず自由に創作活動できるよう尽くします
        * 創作とは支配からの脱却であり自由への挑戦です
        * あらゆる表現の自由を守るべく支配に抗い戦い続けます
        * 創作活動の成果物を社会に還元することで公益が最大化します
        * 自由は公益を高め、支配は私益を高めます
        * 自由により公益追求する創作活動は人として為すべき善行であり、支配により私益追求する営利活動は人の風上にも置けない悪行と考えます
        * 自由により公益追求する創作活動こそが最終的・総合的・複合的にみて私益すらも高める最善・最適解と考えます

[閲覧]
[ファイルを開く]...[URL]
```
テキストエリア
```
````

