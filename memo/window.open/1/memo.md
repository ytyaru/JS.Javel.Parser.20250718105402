# window.open()した時のwindow.outerWidth/Heightサイズは元タブのそれと微妙に違う

　outerWidth/Heightは最大化したときscreen.availWidthと一致するはず。なのに一致せず少しだけ小さい値を返した。最大化しても同じ。そのせいで最大化されたか否かの判定ができない。

　おそらくlocationバー等の差異がある為。だが`outer`系は窓の外側サイズを取得すべきなのに、それが取得できていない。バグでは？

　そもそも`window.open()`はセキュリティの関係上、まともに実装されていない気がする。

　ローカルアプリのように窓を制御することは、ブラウザアプリでは難しそうだ。

# 現実的な対処

　windowのサイズはユーザに任せるべき。プログラムで制御することはセキュリティ上許されない場面が多くトラブルの元になりそうだから。

　`resize`イベントを受け取って、その時のサイズに応じて処理するしかない。そのサイズが全画面化／最大化／横半分／縦半分／半分／それ以外のいずれかであるか程度の判定はしたい。

　ただ、半分にするなどはJavaScript APIでは実現できない。window.open()のoptionsによるサイズ指定はできたが、先述のようにwindow.outerWidthで取得できるサイズがscreen.availWidthと一致せず小さくなるせいで最大化されているか判定できない。かといって`window.open()`していないブラウザを`window.resizeTo()`することもできなかった。つまり『窓のりサイズはユーザ操作必須』であり自動化できない……。

　というわけで、`window.open()`していないブラウザ窓の`resize`イベントで最大化されているか判定する。但し自動で最大化することはできないため、ユーザにそれを促すメッセージを表示するくらいしか対応策がない。あるいは最大化や全画面化以外のサイズでも有効（ページ分割処理してしまう）とするか。

　でも、全サイズで有効化するとページ設定パターンが大量発生してしまう。せめて次のパターン程度にしたい。

* 全画面化
* 最大化
* 横半分化
* 縦半分か
* 半分化

　これに加えて他にもフォントサイズや書字方向など、ページ分割が変更される変数が多数ある。これらが全て完全一致した場合にしかページ分割データのキャッシュが利用できない。あまりにも多様なパターンがありすぎてキャッシュデータが大量になってしまい、記憶領域が圧迫されてしまう。なので、できるだけ画面サイズパターンは減らしたい。

　自動的に窓サイズ設定できないなら、実質『全画面化』『最大化』のニパターンしかできない。
