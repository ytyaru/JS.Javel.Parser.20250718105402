# Javel PWA版 画面構成

* Top
    * About
    * View
    * Edit
    * Make      HTML出力
    * Push      WebAPI(GitHub, AT-Protocol), BlutTooth, File(FileSystemAccess, Download)
    * Convert   小説投稿サイト形式に変換してコピペしやすい画面を提示する
    * Pull      Pushされた情報から小説を一覧する（自分だけでなく他人の小説も）
    * API       API/ライブラリを使用する方法。自作サイトに小説を掲載する方法。

## Top

* This これ自身の名称、要約文、型(PWA,SPA,Web,HTML,Windows,Mac,Linux,iOS,Android)、バージョン値、ソースコードURL、インストール
    * About これ自身が何かの要約
        * Function 機能の要約
        * Policy 方針の要約
    * Demo 動作デモ
        * 埋め込み
            * 表示結果と原稿内容の両方を表示する（出力形式の一覧表示もアイコン等で示す（HTML,CSS,JS,Javel,GZIP））
                * ファイルを表示結果にDnDするとそれをパース・ページ分割して表示する（view）
                * ファイルを原稿内容にDnDするとそれを編集する画面に遷移する（edit）
                * ファイルを出力形式にDnDするとそれをHTMLにしてダウンロードする（make）
        * 画面遷移
            * 本を
                * View 読む
                * Edit 書く
                    * Convert 変換（小説投稿サイト用の形式に相互変換する）
            * サイト・アプリを
                * Make 作る

## About

　これは何か。

項目|値
----|--
名称|Javel
要約|本のように読める小説アプリ
型式|PWA
版値|v1.0.0
URL|🐙GitHubリポジトリへのリンク
INS|インストール／アンインストール／バージョン選択、最新／旧版

### 👍Features(特徴)/Function(機能)

　これは何ができるか。

* 📖ページ分割
* 🖊簡易記法
* 🚛入出力
* 🧩拡張
* 🔗互換
* 👥共有(拡散,通知,SNS)
* ￥投げ銭

### 🧭Policy(方針)

　これは何を為すために作成・公開されたか。

* 目的 
	* 目標 
		* 方針 Policy 自分の意志決定における方向
			* 指針 Guidline 方針を実現する手引書
				* 成果 Deliverables,Artifacts,Works,Output

　Javelの目的は小説の読み書きを楽しむことです。
　Javelの目的はユーザ自身が小説を読み書きすることを楽しむことです。
　Javelの目的はユーザ自身で小説の執筆・読書を楽しむことです。

　Javelはユーザ自身で生活の質を向上することが目的です。
　このうち小説の執筆・読書にフォーカスします。
　Javelの目的はユーザ自身が小説の執筆・読書を楽しむことです。

　Javelは小説を”簡単に"読み書きすることが目的です。
　Javelは小説の読み書きを”簡単に"することが目的です。

　次のような指針です。

* 楽しむために、つまらないことを自動化する（定性化）
	* 自然言語を主体とした原稿で書けること（HTMLのような難解で冗長なコードでなく）
	* 本のようにページを捲って読めるコンテンツを生成できること（スクロールで文字が見切れることなく）
	* 執筆・読書以外の面倒事は自動化できること（データ管理を意識せずに済むこと（インストール、ファイルパス、ファイル保存、DB化、WebAPI、アップロード、デプロイ、告知、Push通知と受取））

　読書は執筆された小説ありきです。執筆の生産効率を向上させれることが読書の効率を向上させることに繋がります。

* 執筆・読書の動機づけ（定量化）
	* 執筆の動機づけ：内的動機づけ（書いた字数の記録・提示）、外的動機づけ（公開／指摘・感想・評価・投げ銭受付）
	* 読書の動機づけ：内的動機づけ（読んだ字数の記録・提示。感想の記録・評価・採点）、外的動機づけ（公開／指摘・感想・評価・投げ銭受付）

* Javelの目的は小説の読み書きを楽しむことです
    * 公益追求／私益排除
    * 永久無料／支払不要
    * 秘密保持／登録不要
    * 改変自由／隠蔽排除
    * 共有拡散／独占排除
    * 創作目的／営利排除

　Javelは自由を愛し、支配を憎みます。公益を追求し、私益を放棄します。それこそが最大利益として自分に返ると信じています。OSS普及や営利メタクソ化が証拠です。故にJavelは権利を放棄し共有財産とします。経済に参加せず自作による共同体を創造します。

* 自由創造／支配破壊
    * 公共公益／私利私欲
        * 共有財産／営利独占
            * 永久無料／支払不要
            * 秘密保持／登録不要
            * 改変自由／隠蔽排除
            * 共有公開／独占排除

　Javelの目的は小説の読み書きを楽しむことです。小説は好きに読み書きできるから楽しいのです。もし誰かに何かを制限されたら楽しみは減衰します。知らない人が、知らない事について語り、知らない世界を垣間見ることができる。それが小説の面白さをなす根源です。よってJavelは楽しむことを阻むあらゆる制限や支配を排除します。すなわち政治・社会・心理・物理・技術的な制限や支配の撤廃にて楽しみを最大化します。何の制限もなく人々の創作がつながる世界を目指します。また、つまらない作業を自動化します。定性化・定量化することで自動化と動機づけをし、人が楽しめるようにします。

　権利・保証とともに義務・責任を放棄して自由になる。組織の所属から抜け、不毛な支配・抑圧・忖度を辞め、個人の思想・活動を自由に追求します。

○：共有・平等・公平・公正・生産・個人・自由・自立・自己決定・自給自足
△：独占・差別・特権・欺瞞・消費・社会・支配・依存・隷属恭順・他力本願

* https://youneedaken.hatenablog.com/entry/2022/04/18/090000
	* `Work product` 成果物
		* `Deliverables`: 納品物、納入物、提供物
		* `Artifact`: 作成物、中間生成物（`Deliverables`未満）
		* `Outcome`: 結果、成果、所産（`Deliverables`,`Artifact`未満）

　Javelは小説の読み書きを楽しむために、公開された既存の仕様であるYAML+Markdown+青空文庫に従い、小説を簡単に書ける構文にしました。また、既存コンテンツを流用・転用できるようHTML、Markdown+HTML、小説投稿サイト形式(なろう、カクヨム、アルファポリス等)、JSONの書式に相互変換できます。Javelから他へ、他からJavelへと相互入出力可能です。また、公開・取得の作業を自動化するために外部サービスWebAPI、BlueToothの方法で通信可能にします。WebAPIはGitHubやAT protocolです。他のWebAPIを使用するよう拡張できます。


# Top

* 最初のユーザ
    * これは何？
    * どう使う？
    * どうなる？
* 熟知ユーザ
    * すぐに読書したい
    * すぐに執筆したい
* 久しぶりユーザ
    * これ何だっけ？

　JavelファイルをDnDしたら？

* すぐに読書できるようページ分割する
* すぐに執筆できるようエディタ表示する
* 読書か執筆のどちらか選択させる

　デモ画面は画面サイズに応じて並べ替えたい。

960<=
+------------+------------+-----+
|Viewer      |Editor      |Maker|
+------------+------------+-----+
640<=
+------------+------------+
|Viewer      |Editor      |
+------------+------------+
|          Maker          |
+-------------------------+
+------------+-----+
|Viewer      |     |
+------------+Maker|
|Editor      |     |
-------------+-----+
640>
+------------+
|Viewer      |
+------------+
|Editor      |
+------------+
|Maker       |
+------------+


縦サイズは横/1.414で算出する。これはA4の白銀比1:√2(1.414)に由来する。

320x240 + 320x240 + 64x240




# About メッセージ

* 📖ページ分割
    * 本のようにページを捲れます
    * スクロールで文字が見切れて続きの位置が分かり難い問題を解決！
* 🖊簡易記法
    * メモ帳で書けます
    * Markdownと青空文庫の書式を参考にしました。メタデータはYAMLで記述します
* 🚛入出力
    * 小説を見せ合おう
    * GitHub, AT-Protocolでネット上に公開でき読めます
* 🔗互換
    * 小説投稿サイトに投稿しよう
    * ルビや傍点の形式を相互変換します。コピペしやすいよう専用画面を生成します
* 👥共有(拡散,通知,SNS)
    * SNSに投稿しよう
    * 小説投稿の告知、誤字指摘、感想文…
* ￥投げ銭
    * 暗号通貨のアドレスを表示・コピペできます
    * MpurseでMONAを送金できます。他は各種ウォレットアプリ等で。
* 🧩拡張
    * 自サイト・自作アプリでJavelの機能を使えます
    * 原稿の解析をハックして独自構文とHTML生成を作り込めます
 


* 🔗互換
    * 小説投稿サイト毎に違うルビや傍点の形式を相互変換します
    * 小説データをコピペしやすいよう専用画面を生成します
* 👁見える化
    * 成果を定量化してモチベUP
    * 作品数、文字数、一覧して

# ページ分割

* Summary: 原稿と隣合わせで表示し、縦書きで、文字が見切れず、ページ捲りで閲覧できること。この領域に原稿をDnDすると全画面表示で計算し表示する。
* Details: 全画面表示で再計算して表示すること

　ページ分割されたJavel本では入出力が可能。長押しで設定画面を出せる。

```
00:00  1/1  作品タイトル ⚙
```
```
作品タイトル
キャッチコピー
帯文
```
```
設定（表示設定を変更してページ分割し直す）
入力（原稿を入力し直す）
出力（File(HTML,EPub,SQLite3), BlueTooth, WebAPI）
Javel（🔗:GitHub, AT-protocol）
```

# 入出力

* Summary: 表示結果と隣合わせで表示し、`<textarea>`で入力し、ボタン押下や`Ctrl+Enter`でページ分割する。この領域に原稿をDnDすると編集画面を表示する。
* Details: リッチエディタ(メタ、本文)／テキストエディタで編集する

　尚、Summaryでは単一HTMLファイル出力ボタンを提示する。その他、WebAPI、BlueToothによる出力はDetailsでのみ提示する。

## File出力

* HTMLファイル
* EPubファイル
* Javelテキストファイル
* SQLite3DBファイル

### HTMLファイル

* パフォーマンス／再利用性
    * bundle(ON/OFF)
        * module(OFF/ON)
        * compress(bundleOFFなら自動的にtgz圧縮)
    * minify(ON/OFF)
* 機能
    * ページ分割
        * 画面（ディスプレイ）
            * 静的: 固定サイズ版
            * 動的: 変動サイズ版
        * 紙面（ペーパー）
            * 静的: 固定サイズ版(A4, B5, ...)
                * 8p/16p
                * 平綴じ
                * 中綴じ
                * 無線綴じ
                * 輪綴じ(リング綴じ)
                * 糸綴じ(糸かがり綴じ)
    * 原稿
        * 静的：HTML内埋込（原稿入力不可）
        * 動的：ファイル、URL、テキストエリアから入力受付可能版（初期値は指定された原稿である）

### Javelテキストファイル

### SQLite3DBファイル

　目的によって最適な方法が変わる

* 特定著者の作品一覧を作る
* 不特定多数の著者全員の作品を網羅する

　もし前者ならヘッダ用ファイルだけを作成する方法のほうが有効か。

特定著者ID.yml
```
author:
  id: UUIDv7をBASE64URL化したもの
  name: 任意テキスト
works:
  - {id:, title: ,catch: , obi:, updated:, chars:}
  - ...
```

* javel.db
    * authors
    * works
        * headers
        * contents

#### authors 著者

name|summary
----|-------
id|int|SQLite3 DB内ID
key|str|UUIDv4 URLやファイル名で使用できる文字だけを使い余計な記号を排除した文字列
name|str|筆者名。Javel形式でルビを振れる。
url|str|JSON形式。`{site:https://..., x:https://..., ...}`
coin|str|JSON形式。`{mona:アドレス, btc:アドレス, ...}`

UUID v4よりも短く、同程度の衝突確率となるユニークなURL用文字列を自動生成したい (UUID v4 → Base64)
https://zenn.dev/medirom_tech/articles/ffcf8a6f8f8708
UUID
https://qiita.com/cvusk/items/b21f4847ac09eeb7fe5c

v|構造
-|----
1|time_low/time/time_high/ver/node
4|random/ver/random/ver
5|namespace/hash/hash
6|time_high/ver/time/clock_sq/node
7|unix_ts_ms/ver/random/var

　そのものを示す識別子・記号・名称。

英|意味
--|----
id|アイデンティティ。一意。内部識別子。SQLite3内における識別子。Number型。
key|鍵。扉を開き中の物を取得するために必要なもの。文字列。外部識別子。URLやファイル名に使用可能な識別子。String型。
code|符号・暗号。`code-name`
name|名前。上記はマシンリーダブルだが、nameは人間が識別する名称。

英|意味
--|----
type|型、型式、型番
kind|種類
category|分類
genre|ジャンル

#### works 作品

name|summary
----|-------
aid|int|この作品を所有する著者ID
id|int|SQLite3 DB内ID
key|str|UUIDv7 URLやファイル名で使用できる文字だけを使い余計な記号を排除した文字列
title|str|タイトル（改行でh1〜h6まで表現。Javel形式でルビを書ける）
catch|str|キャッチコピー（改行でh1〜h6まで表現。Javel形式でルビを書ける）
obi|str|帯文（Javel形式で複数のパラグラフを書ける）
category|str|カテゴリ
tag|str|タグ
warn|str|警告
writeCount|int|原稿の文字数
readCount|int|原稿を読書する時の文字数（本文のみの字数。メタ文字、見出し、ルビ文字等を削除した字数）
contents|str|本文

##### headers

name|summary
----|-------
aid|int|この作品を所有する著者ID
id|int|SQLite3 DB内ID
key|str|UUIDv7 URLやファイル名で使用できる文字だけを使い余計な記号を排除した文字列
title|str|タイトル（改行でh1〜h6まで表現。Javel形式でルビを書ける）
catch|str|キャッチコピー（改行でh1〜h6まで表現。Javel形式でルビを書ける）
obi|str|帯文（Javel形式で複数のパラグラフを書ける）
category|str|カテゴリ
tag|str|タグ
warn|str|警告
writeCount|int|原稿の文字数
readCount|int|原稿を読書する時の文字数（本文のみの字数。メタ文字、見出し、ルビ文字等を削除した字数）

##### contents

name|summary
----|-------
id|int|SQLite3 DB内ID
text|str|本文

##### diff

name|summary
----|-------
wid|この変更履歴を持つ作品ID
id|int|この変更履歴の識別子（UUIDv7を識別子にすればSQLite3内とファイル／URLでの識別子を共用できるかも？　ついでに日時も含まれる）
diff|str|diff文字列。差分テキストを生成するためのテキスト。

###### section

　本文を一話ずつ分割したテキスト。

name|summary
----|-------
wid|この変更履歴を持つ作品ID
id|int|この変更履歴の識別子（UUIDv7を識別子にすればSQLite3内とファイル／URLでの識別子を共用できるかも？　ついでに日時も含まれる）
text|str|一話あたりの本文

## BlueTooth出力

## WebAPI出力



# 🔗互換

* Summary: 
* Details: 

```
      +----+ +-----------+
Javel |→▼| |なろう   ▼|
      |←  | |カクヨム   |
      +----+ |AP         |
             |...        |
             +-----------+
```

## Javel→他(カクヨム)

　* Summaryの`<textarea>`で入力されたJavel原稿から、所定の小説投稿サイト形式に変換したものを表示し、サイトの投稿画面にペーストしやすい画面を提示する。

```
+----------------+
|全文コピー/DL   |
+----------------+
+----------------+
|表紙          ▼|
|章立てのみ　　  |
|話題と本文のみ  |
+----------------+
nnnn(現在位置)/nnnn(コピー項目数)  完了率％
コピー項目名（作品タイトル、キャッチコピー、あらすじ、章タイトル、話タイトル、本文）
+--+------------------+--+
|前|コピーするテキスト|次|
+--+------------------+--+
+-----------------+
|コピーしました！ |
+-----------------+
```

　`次`ボタンを押すと次々にテキストをクリップボードへコピーする。あとはそれを各小説投稿サイトの編集画面にペーストする。

* `コピーするテキスト`は2行10+10字文の`<textarea>`で、クリックするとクリックボードにコピーされる
* `前`,`次`を押下するとコピーするテキストが変化し、それがコピーされる

　もし各小説投稿サイトが投稿用WebAPIを用意してくれたら、こんな面倒な作業をせずに済むよう自動化できたのに……。

## 他(カクヨム)→Javel

```
+----------------+
|表紙      　　▼|
+----------------+

表題    [????????????????????]
キャッチ[????????????????????]
あらすじ[????????????????????]

カテゴリ[????????????????????]
タグ    [????????????????????]
注意    [????????????????????]
```
```
+----------------+
|章立て    　　▼|
+----------------+
n部n章n話   ↑↓(位置入替)
+----+ +----------------+--+
|大▼| |大見出しタイトル|❌| 一部　はじまり
+----+ +----------------+--+
+----+ +----------------+--+
|中▼| |中見出しタイトル|❌| 一章　旅立ち
+----+ +----------------+--+
+-----------------------+--+
|中見出しタイトル       |❌| 一話　ガンダム、大地に立つ
+-----------------------+--+
+-----------------------+--+
| ＋ 見出し／本文▼     |❌|
+-----------------------+--+
```
```
+----------------+
|話題と本文    ▼|
+----------------+
nnnn(現在位置)/nnnn(ペースト項目数)  完了率％      累計文章量（n字n話n章n部）
ペースト対象項目名（n話n章n部）
+--+ +-----------------------+ +--+
|前| |ここにペーストしてね   | |次|
+--+ +-----------------------+ +--+
```



# Viewer

* 全画面Viewer
* 全画面Viewer + Editor 半々
* 任意サイズ

## フッタ

向	段	フッタ位置、向き
H	1	底辺H
H	2	中央V
V	1	底辺H
V	2	中央H

+------------------+	+------------------+
|０１２            |	|０１２      ６７８|	
|３４５            |	|３４５      ９０１|	
+------------------+	+------------------+	
+------------------+	+------------------+
|              ３０|	|              ３０|	
|              ４１|	|              ４１|	
|              ５２|	|              ５２|	
+------------------+	|                  |
						|              ９６|
						|              ０７|
						|              １８|
						+------------------+

フッタを付与する。

+------------------+	+--------+-+-------+
|０１２            |	|０１２  |f| ６７８|	
|３４５            |	|３４５  |o| ９０１|	
+------------------+	+--------+-+-------+	
|footer            |
+------------------+
+------------------+	+------------------+
|              ３０|	|              ３０|
|              ４１|	|              ４１|
|              ５２|	|              ５２|
+------------------+	|      footer      |
|footer            |	|              ９６|
+------------------+	|              ０７|
						|              １８|
						+------------------+

フッタの位置は次のように決定した。

1. 本に近づける
2. 余白を減らして文字を多く詰める（ページめくり回数を減らす。画面を有効活用する）

つまり縦書き、横書きであろうが下部に表示する。
但し、二つに分割した時は中央に配置する。
もし本(紙面)なら中央は糊付けされて余白しか表示できないが、これはディスプレイなので有効活用できる。
特に本は白銀比(1:√2(1.414))に対して、画面は16:9(1.77:1)なので比率に大きな差がある。
よって画面は本の再現より画面を有効活用するほうが読みやすく効果的と判断し、画面を二段にしたりフッタを中央にするようにした。

## 設定

* 人
    * 筆者・著者
    * 読者
    * 作者・開発者
* 物
    * 本・小説・作品名
    * 拡散・感想・指摘・評価・投げ銭
    * アプリ・Javel

+-------------+ 表紙を見る      読了率％
|作品名       | 表示設定
|著者名 文字数| ダウンロード
+-------------+ 
+-------------+                 完遂率％
|読者名       | 
|■■■       | 拡散・感想・指摘・評価・投げ銭
|米:N 感:N 評:|
+-------------+
+-------------+ 操作方法        完遂率％
|Javel        | 使い方
+-------------+ Javelについて



### スマホ

* 表紙を見る
* 表示設定
* Javelについて


◀項目名▶

